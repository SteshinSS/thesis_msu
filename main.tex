\documentclass[14pt, a4paper]{extreport}
%\usepackage[a4paper, left=30mm,right=15mm,top=20mm,bottom=20mm, footskip=.25in]{geometry}
\usepackage[a4paper]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{mhchem} % for 13C
\usepackage{verbatim} % for multiline commentary 
\usepackage{graphicx} % for logo
\usepackage{titling} % for shift margins
\usepackage{blindtext} % for text-generation
\usepackage{setspace} % to set interval
\usepackage[numbers,sort&compress]{natbib} % for range cite [1-4]
\usepackage{todonotes} % todo
\usepackage{amsmath} % for matrices
\usepackage{amssymb}
\usepackage{titlesec}
\usepackage[toc]{appendix} % for appendix
\usepackage{wrapfig} % for pictures
\usepackage{subcaption} % for caption of two side-by-side pictures
\usepackage{array, booktabs} % for timeline
\usepackage{multirow}
\usepackage{xparse}
\usepackage{float}
\usepackage{multicol}
\usepackage{amsthm}

\NewDocumentEnvironment{sidebyside}{O{.50} o +m +m}{%
	\noindent\begin{minipage}[t][][t]{#1\linewidth}%
		#3% Content of the first minipage
	\end{minipage}%
	\hfill%
	\noindent\begin{minipage}[t][][t]{\IfValueTF{#2}{#2}{#1}\linewidth}%
		#4% Content of the second minipage
	\end{minipage}\\% newline is important, it allows \hfill to work correctly, try removing it ;)
}


\newcommand{\adj}[1]{\raisebox{-2pt}[\height][\depth]{#1}}

\newcommand{\foo}{\makebox[0pt]{\textbullet}\hskip-0.5pt\vrule width 1pt\hspace{\labelsep}}
\renewcommand{\appendixtocname}{Приложения}

\titleformat{\chapter}[display]
{\normalfont\bfseries}{}{0pt}{\Huge} % get rid of "chapter"

\newcommand{\CC}{C\nolinebreak\hspace{-.05em}\raisebox{.4ex}{\tiny\bf +}\nolinebreak\hspace{-.10em}\raisebox{.4ex}{\tiny\bf +}}
\def\CC{{C\nolinebreak[4]\hspace{-.05em}\raisebox{.4ex}{\tiny\bf ++}}} % define pretty C++


\graphicspath{ {./pics/} }
\begin{document}

\begin{titlepage}
	\begin{centering}
		\includegraphics[width=0.27\textwidth]{logo.png}\par
	\end{centering}
	\centerline{Московский государственный университет имени М. В. Ломоносова}
	\centerline{Факультет вычислительной математики и кибернетики}
	\centerline{Кафедра математической кибернетики}
	\centerline{\hfill\hrulefill\hrulefill\hfill}
	\vfill
	\vfill
	\large
	\centerline{Стешин Семен Сергеевич}
	\vfill
	\Large
	\begin{centering}
		\textbf{Khnum: быстрая open-source программа \\ для расчета метаболических потоков \\ с использованием \ce{^{13}C}-углерода}
		
	\end{centering}
	\normalsize
	\vfill
	\centerline{Выпускная квалификационная работа}
	\vfill
	\vfill
	\begin{flushright}
	Научный руководитель:\\
	к.ф.м.н., доцент \\
	Шуплецов М. С.
	\end{flushright}
	\vfill
	\vfill
	\centerline{Москва --- 2020}

\end{titlepage}




\begin{abstract}
Важная задача биологии и медицины --- определение скорости метаболических потоков внутри клетки. 
Мощный метод решения этой задачи --- \ce{^{13}C}-Metabolic Flux Analysis --- анализ метаболических потоков с использованием  \ce{^{13}C}-углерода. 
В этом методе исследователи проводят эксперимент и обрабатывают его результаты на компьютере. Для этого решают обратную задачу: подбирают такие метаболические потоки, чтобы результат компьютерной симуляции совпал с экспериментальными данными. Проблема в том, что современные программы для анализа метаболических потоков либо имеют закрытый код и платны для коммерческого использования, либо написаны неэффективно, из-за чего вычисления могут занимать недели для одного эксперимента. В этой работе доказана принадлежность ключевой матрицы метода к классу М-матриц, что позволило использовать специальные численные методы. Для решения задачи написана эффективная программа Khnum с открытым исходных кодом на языке \CC{}, проведено сравнение с существующими аналогами.
\end{abstract}
\addtocounter{page}{2}
\newgeometry{ left=30mm,right=15mm,top=20mm,bottom=20mm}
\tableofcontents

\chapter[Введение]{\thechapter{}. Введение}
Рак --- вторая по частоте причина смерти в мире\cite{Cancer_statistics}. Сто лет назад Отто Варбург заметил\cite{Warburg_effect} особенность раковых клеток: они склонны производить энергию с помощью активного гликолиза, вместо более эффективного окислительного фосфорилирования. Знание этого позволило находить опухоли с помощью позитронно-эмиссионной томографии, а Варбурга наградили Нобелевской премией.

Диабетом болеет 8.8\% людей в мире\cite{Diabetes_statistics}. Почти 4 миллиона в год умирает из-за этой болезни. Лечения пока нет, но есть симптоматическая терапия инъекциями инсулина. Раньше его получали из поджелудочных желез свиней и коров, но препарат было сложно очистить, поэтому иногда случались аллергические реакции. Все изменилось в 1978 году, когда компания Genentech смогла создать генетически-модифицированную кишечную палочку, которая в ходе жизнедеятельности производила чистый человеческий инсулин\cite{Genentech_paper}. Сейчас таким образом производят почти весь препарат.

В первом случае, открытие заключалось в изменении скорости химической реакции, протекающей внутри клетки. В случае с инсулином, решается задача метаболической инженерии --- увеличить скорость синтеза инсулина, не убив кишечную палочку. В обоих случаях надо уметь измерять скорости внутриклеточных химических реакций -- их называют потоками. Один из современных методов измерения потоков -- \emph{\ce{^{13}C}-Metabolic Flux Analysis} (\emph{\ce{^{13}C}-MFA}), что переводится как анализ метаболических потоков. Его применяют в исследованиях рака\cite{Application_cancer_2009, Application_cancer_2012, Application_cancer_2013, Application_cancer_2015, Application_cancer_2017, Application_cancer_2018, Application_cancer_2018_2}, в~метаболической инженерии\cite{Application_engeneering_2009, Application_engeneering_2015, Application_engeneering_2017} и в других областях\cite{Application_other_2011, Application_other_2013, Application_other_2014}. Этому методу и посвящена работа.

	\section{Анализ метаболических потоков}
\begin{figure}[t]
	\includegraphics[width=1\textwidth]{experiment.png}\par
	\caption{Схема эксперимента}
	\label{experiment}
\end{figure}
Химические реакции, протекающие внутри клетки называют \emph{метаболическими потоками}, а их реагенты --- \emph{метаболитами}. Задача состоит в определении скоростей внутриклеточных потоков. 

Напрямую можно измерить только внешние потоки --- например, с какой скоростью поглощается глюкоза или с какой скоростью выделяется~\ce{CO_2}. Внутренние потоки восстанавливают из <<сцепленной>> информации, полученной в эксперименте. 

В методе \ce{^{13}C}-MFA <<сцепленной>> информацией становится распределение особых атомов. Для этого используется входной субстрат, у которого некоторые атомы углерода заменены на стабильный тяжелый изотоп \ce{^{13}C}, называемый \emph{трейсером}\footnote{На самом деле, использовать углерод не обязательно. В последнее время появились работы, использующие \ce{^{15}N} азот \cite{nitrogen_mfa} или \ce{^{34}S} серу \cite{sulfur_mfa}. Эти стабильные изотопы позволяют исследовать метаболические пути, в которых нет углерода, однако для большинства приложений хватает более доступных субстратов с меченным углеродом.}.
На этом субстрате выращивается колония клеток, и тяжелый углерод распространяется по метаболитам в ходе химических реакций. То, как он распределится, зависит от скоростей потоков, поэтому узнав распределение, можно математическими методами восстановить значения метаболических потоков.



\subsection{Эксперимент}
Хотя, текущая работа концентрируется на численном моделировании, опишем эксперимент\cite[стр. 312]{protocol}, схема которого изображена на рис. \ref{experiment}. Исследователь выращивает клетки на субстрате, содержащем \ce{^{13}C}-углерод (например, глюкозе). Когда трейсер распределится по биологической системе, изолируем некоторые метаболиты: например, аминокислоты, полученные гидролизацией белков. Молекулы этих метаболитов содержат разное количество меченных атомов и, поэтому отличаются по массе. Найдем долю молекул разной тяжести. 

<<Взвешивать>> молекулы можно с помощью газовой хромато-масс-\\спектрометрии, при этом для каждого метаболита на выходе получим так называемый \emph{Mass Isotopomer Distribution} (далее \emph{MID}) --- вектор $\mathbf{MID} = [M_0, M_1, \ldots, M_n]$, где $M_i$ --- массовая доля метаболита с $i$ атомами трейсера, и $\sum_{i = 0}^{n} M_i= 1$ (См. таблицу \ref{MID}).

 \begin{wraptable}{r}{0.3\linewidth}
	\renewcommand{\arraystretch}{1.5}
	\begin{tabular}{c | c}
		\hline
		Меченность & Масса\\ 
		\hline
		\includegraphics{emus/000.png} & $m_0$\\
		\hline
		\includegraphics{emus/001.png} & \\
		\includegraphics{emus/010.png} & $m_0 + 1$\\
		\includegraphics{emus/100.png} & \\
		\hline
		\includegraphics{emus/011.png} & \\
		\includegraphics{emus/101.png} & $m_0 + 2$\\
		\includegraphics{emus/110.png} & \\
		\hline
		\includegraphics{emus/111.png} & $m_0 + 3$\\
	\end{tabular}
	\caption{Распределение трейсера и вес молекулы}
	\label{MID}
\end{wraptable} Набор таких векторов --- это распределение трейсера, 
 поэтому он служит входными данные математической задачи. Подробные протоколы эксперимента можно найти в \cite{protocol_animal} для животных клеток и в \cite{protocol_plant} для растений.


\subsection{Математическая модель}
Существуют разные подходы к вычислению метаболических потоков. Чаще всего задачу решают как обратную. Для этого создают математическую модель, предсказывающую MID метаболитов при заданных скоростях потока; пишут программу для симуляции, а затем решают задачу регрессии: подбирают такие значения потоков, при которых предсказанные в симуляции MID совпадают с полученными в эксперименте. 

На вход прямой симуляции подается 
\begin{itemize}
	\item MID входного субстрата.
	\item Полный набор химических реакций клетки и их реагентов.
	\item Скорости всех метаболических потоков.
\end{itemize}
На выходе получается MID-вектор экспериментально измеренных метаболитов. Общая схема представлена на рис. \ref{direct_simulation}.


На вход задачи регрессии также подаются MID входного субстрата и полный набор химических реакций, а кроме того:
\begin{itemize}
	\item Экспериментально измеренные MID некоторых метаболитов.
	\item Если есть --- измеренные внешние потоки (например, скорость поглощения глюкозы).
	\item Если есть --- ограничения на скорости потоков, известные из биологических соображений.
\end{itemize} 
В ходе решения регрессии, восстанавливаются скорости метаболических потоков. Конечно, обратная задача может иметь несколько решений, поэтому результат должен проанализироваться биологом. Формальное описание и решение модели в главе 2.

\clearpage
\begin{multicols}{2}[]
	\begin{table}[H]
		\renewcommand\arraystretch{1.4}
		\captionsetup{singlelinecheck=false, labelfont=sc, labelsep=quad}
		\caption{История}\vskip -1.5ex
		\begin{tabular}{@{\,}r <{\hskip 2pt} !{\foo} >{\raggedright\arraybackslash}p{5cm}}
			\toprule
			\addlinespace[1.5ex]
			1982 & Первый MFA с углеродом\cite{first_MFA}\\
			1988 & Появление термина <<изотопомер>>\\
			1997 & W. Weichert, изотопомерная модель\cite{Wiechert_1997_1, Wiechert_1997_2}\\
			1999 & W. Weichert, кумомерная модель\cite{Wiechert_1999_3, Wiechert_1999_4}\\
			2007 & W. Weichert, программа 13CFLUX\cite{13CFlux1}\\
			2007 & M. Antoniewicz, EMU модель\cite{EMU_2007}\\
			2008 & M. Antoniewicz, программа Metran\cite{Metran}\\
			2009 & L. Quek, программа OpenFlux\cite{OpenFlux}\\
			2013 & W. Weicher, программа 13CFLUX2\cite{13CFLUX2}\\
			2014 & М. Шуплецов, OpenFlux2\cite{OpenFlux2}\\
			2016 & R. Nilsson, M. Jain, первое MFA с несколькими трейсерами сразу\cite{nitrogen_mfa}\\
			2017 & M. Borkum, строгая формализация EMU-модели\cite{formalizm_2017}\\
			2019 & C. Foguet et al, программа iso2flux\cite{p13CMFA}\\
		\end{tabular}
	\end{table}
	\columnbreak
	
	\begin{figure}[H]
		\includegraphics[width=0.9\linewidth]{direct_simulation.png}
		\captionof{figure}{Прямая симуляция}
		\label{direct_simulation}
	\end{figure}
	\subsubsection{Историческая справка}
	В восьмидесятые годы углерод начали использовать для анализа метаболических потоков. В 1997 году	
	W. Wiechert разработал удобную модель распространения углерода. За следующие два года автор построил математически эквивалентную модель, которая быстрее расчитывалась на компьютере. В 2007 году M. Antoniewicz создал EMU-модель, которая остается самой популярной среди программных реализаций. Так же существуют прямые модели\cite{Direct_MFA}, вероятностные модели на основе Марковских цепей\cite{Markov_chain_MFA} и другие\cite{Fluxomer_MFA}. В этой работе подробно разбирается EMU-модель.
\end{multicols}




\clearpage
\subsection{Программная реализация}
\begin{figure}[b]
	\centering
	\includegraphics[width=0.60\textwidth]{hpc.png}
	\caption{Высокопроизводительные вычисления}
	\label{hpc}
\end{figure}
Анализ метаболических потоков --- вычислительно сложная задача, поэтому много работ посвящено совершенствованию математических моделей и алгоритмов. Увеличение вычислительной мощи позволяет уменьшить время расчетов, повысить точность и снизить стоимость экспериментов.

Высокопроизводительные вычисления состоят из нескольких компонентов(см. рис \ref{hpc}). Современная компьютерная архитектура позволяет использовать векторные инструкции (SSE, AVX), многопоточность (в том числе, Hyper-Threading) и кеширование. Языки, такие как \CC{} позволяют писать эффективные реализации, тонко управляя процессором. Используемые численные методы должны не только иметь хорошие теоретические свойства, но и эффективно исполняться на архитектуре пользователя.

Сейчас существует много программ для проведения \ce{^{13}C}-MFA расчетов (см. приложение А), но большинство из них неэффективны. Хотя программы работают правильно, они не учитывают особенности работы процессора и оперативной памяти. Такие языки как Python и Matlab удобны для разработки, но не позволяют развить максимальную эффективность решения задачи \ce{^{13}C}-MFA.

Единственная существующая программа на языке \CC{} имеет закрытый код и платна для коммерческого использования. По запросу можно получить бесплатную академическую лицензию, но для использования надо заранее отправить разработчикам входные данные.

\chapter[Основные понятия]{\thechapter{}. Основные понятия}
\section{Список определений}
Некоторые термины вводятся позже.

\hangindent=1cm \noindent
\emph{\ce{^{13}C}-MFA} --- \ce{^{13}C}-Metabolic Flux Analysis, Анализ метаболических потоков с использованием \ce{^{13}C}-углерода.

\hangindent=1cm \noindent
\emph{Метаболический поток} --- Внутриклеточная химическая реакция.

\hangindent=1cm \noindent
\emph{Метаболит} --- Реагент метаболического потока.

\hangindent=1cm \noindent
\emph{Субстрат} --- 1. Питательная среда для микроорганизмов. 2. Исходные реагенты химической реакции.

\hangindent=1cm \noindent
\emph{Продукт} --- Конечные реагенты химической реакции.

\hangindent=1cm \noindent
\emph{Трейсер} --- Тяжелый стабильный изотоп, который отслеживается в MFA. Обычно это \ce{^{13}C}.

\hangindent=1cm \noindent
\emph{MID} --- Mass Isotope Distribution, вектор $\mathbf{MID} = [M_0, M_1, \ldots, M_n]$, соответствующим метаболиту $M$, где $M_i$ --- массовая доля молекул метаболита с $i$ атомами трейсера, и $\sum_{i = 0}^{n} M_i = 1$.

\hangindent=1cm \noindent
\emph{Изотопомеры} --- Молекулы одного вещества, содержащие одинаковое количество изотопов и, как следствие, массу. Изотопы могут находится в разных позициях.

\hangindent=1cm \noindent
\emph{Стехиометрическая матрица} --- Матрица $\mathbf{S}$, в которой каждый элемент $s_{ij}$ равен коэффициенту метаболита $M_i$ в химическом уравнении $K_j$. В стационарной системе, при умножении на столбец метаболических потоков даст ноль.

\hangindent=1cm \noindent
\emph{Метаболическая сеть} --- Ориентированный гиперграф, вершины которого --- метаболиты, ребра --- химические реакции, и для каждой химической реакции известно, какой атом трейсера в какой переходит.

\hangindent=1cm \noindent
\emph{EMU} --- Elementary Metabolic Unit --- это любое непустое подмножество атомов трейсера.

\hangindent=1cm \noindent
\emph{Размер EMU} --- Количество атомов в EMU.

\hangindent=1cm \noindent
\emph{Размер EMU-реакции} --- Сумма размеров реагентов EMU-реакции.

\hangindent=1cm \noindent
\emph{EMU-граф} --- граф EMU-реакций одного размера.



\clearpage

\section{Предположения}
Математическая модель для \ce{^{13}C}-MFA основывается на нескольких предположениях о биологической системе\cite{Wiechert_1997_1}:
\begin{enumerate}
	\item[(1П)] Наблюдаемая система должна находится в стационарном состоянии. Для этого экспериментаторы выжидают некоторое время, пока трейсер распространяется по системе.\footnote{В этой работе рассматривается только \emph{Stationary MFA}, но существуют так же Non-Steady MFA\cite{NMFA}, в котором делают несколько замеров, пока трейсер распределяется, и Dynamic MFA\cite{DMFA}, в котором сами метаболические потоки меняются со временем. Эти модели не так развиты из-за своей вычислительной сложности.}
	
	\item[(2П)] Метаболическая карта должна быть полной. То есть, для интересующих метаболических потоков должны быть известны все предшествующие химические реакции, и в них должны быть известны все переходы атомов углерода.
	
	\item[(3П)] Изотопические массовые эффекты несущественны. То есть химические реакции протекают одинаково как с \ce{^{12}C}, так и с \ce{^{13}C}. Это обычно так, но есть небольшие отличия для малых молекул, например, \ce{CO_2}.
	
	\item[(4П)] Популяция клеток однородна. Современные техники позволяют измерять потоки <<в среднем>>. Это сработает только, если клетки не сильно отличаются друг от друга.
\end{enumerate}

Заметим, что разным математическим моделям могут соответствовать разные допущения. Этот вопрос подробно разбирался в работе \cite{formalizm_2017}, там же формально был доказан изоморфизм нескольких популярных моделей.
\clearpage


\section{Обратная задача}

Сформулируем обратную задачу как задачу минимизации. Пусть $\mathbf{v}$ --- скорости метаболических потоков. На потоки накладываются разные ограничения, поэтому они должны принадлежать \emph{пространству допустимых потоков} $U \subset \mathbb{R}^n$. Подберем такие $\mathbf{v} \in U$, чтобы минимизировать квадрат разности между экспериментально измеренными MID $\mathbf{x}_{mea}$ и предсказанными\footnote{Предсказанию $\mathbf{x}_{calc}(\mathbf{v})$ посвящен следующий раздел 2.4 Прямая симуляция.} MID $\mathbf{x}_{calc}(\mathbf{v})$. Для этого учтем, что измерения проводились с погрешностью. 

Пусть $\mathbf{\sigma}_{mea}$ --- ошибки измерения $\mathbf{x}_{mea}$, $\mathbf{\Sigma}(\mathbf{\sigma}_{mea})$ --- матрица ковариации ошибок измерения. Если ошибки независимы и распределены нормально, то $\mathbf{\Sigma}(\mathbf{\sigma}_{mea})$ --- это диагональная матрица $diag(\sigma_{1}^2, \sigma_{2}^{2}, \dots, \sigma_{n}^2)$. Тогда математическая задача \ce{{}^13C}-MFA формулируется так:
$$\min_{\mathbf{v} \in U}{ } (\mathbf{x}_{mea} - \mathbf{x}_{calc}(\mathbf{v}))^T \times \mathbf{\Sigma}^{-1} \times (\mathbf{x}_{mea} - \mathbf{x}_{calc}(\mathbf{v})). \eqno (1.1)$$


\begin{wrapfigure}{r}{0.5\linewidth}
	\includegraphics[width=1\linewidth]{inverse_problem.png}
	\captionof{figure}{Обратная задача}
	\label{inverse_problem}
\end{wrapfigure}

Существуют различные оптимизационные методы решения этой задачи. Чаще всего применяется метод Левенберга-Марквардта. Для нахождения минимума, начальные потоки $\mathbf{v} \in U$ задаются случайно, и запускается метод оптимизации, который учитывает ограничения $U$. Когда минимум найден, его координаты сохраняются и процесс запускается снова. Через достаточное количество итераций, мы можем получить несколько локальных минимумов, один из которых соотвествует искомым метаболическим потокам $\mathbf{v}$(см. рис \ref{inverse_problem}). Его выбирают из биологических соображений.

Обсудим пространство допустимых потоков $U$. Чем оно меньше, тем быстрее найдется глобальный минимум. Для каждого потока можно считать, что он неотрицателен и ограничен сверху. Биолог может задать дополнительные ограничения --- в большинстве случаев, линейные. Кроме того, мы можем уменьшить размерность системы.

\subsection{Стехиометрическая матрица}

Введем понятие \emph{стехиометрической матрицы}. Пусть $M_1, M_2, \dots, M_n$ --- метаболиты, $K_1, K_2, \dots, K_m$ --- система химических уравнений. 
Составим матрицу $\mathbf{S} \in \mathbb{R}^{n \times m}$ порядка $n \times m$. В ней элемент $s_{ij}$ равен коэффициенту метаболита $M_i$ в уравнении $K_j$.

Например, рассмотрим химическое уравнение:

\begin{center}
	\ce{Na + H_2O = NaOH + H_2}.
\end{center}

Расставим коэффициенты:

\begin{center}
	\ce{2Na + 2H_2O = 2NaOH + H_2}.
\end{center}

Перенесем все в левую часть:

\begin{center}
	\ce{2Na + 2H_2O - 2NaOH - H_2 = 0}.
\end{center}
Тогда этому уравнению будет соответствовать столбец $\begin{pmatrix}
2 & 2 & -2 & -1\\
\end{pmatrix}^T$. Сделав так для каждого уравнения системы, получим разреженную матрицу, которую называют \emph{стехиометрической}.

Запишем, так называемое, уравнение материального баланса:

$$\frac{d\textbf{c}}{dt} = \textbf{Sv} - \mu{}\textbf{c}.$$

Здесь записан закон сохранения массы в дифференциальном виде. $\textbf{c}$~---~столбец концентраций метаболитов, $\textbf{S}$ --- стехиометрическая матрица, $\textbf{v}$ --- столбец метаболических потоков. Коэффициент $\mu$ отвечает за разведение метаболитов из-за клеточного роста, со скоростью $\mu$. По предположению (1П), система находится в стационарном состоянии, поэтому концентрации метаболитов не меняются $\frac{d\textbf{c}}{dt} = 0$. Клетки растут медленно, коэффициент $\mu$ обычно мал и им можно пренебречь. Тогда:
$$ \textbf{Sv} = 0.$$
Обычно, $\mathbf{S}$ --- неполного ранга, поэтому систему можно параметризовать:
$$ \mathbf{v} = ker(\mathbf{S}) \cdot \mathbf{v}_{free},$$
где $ker(\textbf{S})$ --- матрица ядра стехиометрической матрицы $\mathbf{S}$. Ее подбирают таким образом, чтобы в $\mathbf{v}_{free}$ было как можно больше экспериментально измеренных внешних потоков.

Кроме параметризации, такое условие $\mathbf{v} = ker(\mathbf{S}) \cdot \mathbf{v}_{free}$ позволяет сузить пространство допустимых потоков $U$ линейными ограничениями, если учесть, что потоки ограничены: $\mathbf{0} \le \mathbf{v} = ker(\mathbf{S}) \cdot \mathbf{v}_{free} \le \mathbf{b}$.



\clearpage
\section{Прямая симуляция}
Опишем модель EMU, предложенную Мачеком Антониевичем в 2007 году\cite{EMU_2007}. Хотя эта модель вдохновила многих разработчиков, автор не доказал ее корректность и не объяснил, почему она работает. В ответ на это в 2017 году вышла статья\cite{formalizm_2017}, авторы которой формализовали математическую модель и доказали ее корректность. Мы опишем модель так, как она была введена автором, потому что так нагляднее. Этого хватит для доказательства результатов, а строгий читатель может обратиться к работе 2017 года. 

Рассмотрим ориентированный гиперграф, вершины которого соответствуют метаболитам, а ребра --- химическим реакциям. Для каждой реакции известно, какой атом углерода в какой переходит. Такой граф называют \emph{метаболической сетью}.

На вход прямой симуляции подается:
\begin{itemize}
	\item MID входных субстратов.
	\item Метаболическая сеть.
	\item Скорости всех потоков.
\end{itemize}
На выходе --- MID экспериментально измеренных метаболитов.
Для этого мы построим графы специального вида (\emph{графы EMU-реакций}), по которым построим каскад СЛАУ, решение которых содержит искомые MID.

\subsection{EMU}

\begin{wraptable}{r}{0.35\linewidth}
	\begin{tabular}{c | c}
		EMU & Обозначение\\
		\hline
		\includegraphics[scale=0.6]{emus/EMUA1.png} & $A_1$\\
		\hline
		\includegraphics[scale=0.6]{emus/EMU13.png} & $A_{13}$\\
		\hline
		\includegraphics[scale=0.6]{emus/EMU123.png} & $A_{123}$\\
	\end{tabular}
	\caption{Обозначения EMU}
	\label{EMU}
\end{wraptable}

Пусть $A$ --- молекула. Любое подмножество атомов трейсера молекулы $A$ будем называть \emph{Elementary Metabolic Unit} (далее \emph{EMU}). Например, если $A$ состоит из трех атомов трейсера, обозначим через $A_{13}$ EMU состоящее из первого и третьего атома углерода (см. рис \ref{EMU}). На атомах трейсера одной молекулы задан естественный порядок. \emph{Размером} EMU назовем количество атомов в этом EMU.

Нас интересует только распределение трейсера, поэтому вместо всех метаболитов сети, будем рассматривать только их EMU. Вместо химических реакций, будем рассматривать EMU-реакции. Можно выделить три типа EMU-реакций (см. таблицу \ref{EMU_reactions}):
\begin{itemize}
	\item Конденсации (condensation)
	\item Расщепления (cleavage)
	\item Унимолекулярная (unimolecular)
\end{itemize}
Любую химическую реакцию можно свести к нескольким EMU-реакциям этих типов. Обратим внимание, что MID продукта EMU-реакции однозначно определяется MID исходных субстратов. С этого момента будем ассоциировать обозначение EMU с его MID.

\begin{table}[!h]
	\begin{center}
		\begin{tabular}{c | c}
			\hline
			EMU-реакция & MID\\
			\hline
			\multirow{5}{*}[-1mm]{
				\begin{minipage}{0.3\linewidth}
					\centering{Реакция конденсации}
					\includegraphics[scale=0.85]{EMU_reaction_1.png}
				\end{minipage}
			} 
			& \adj{$\mathbf{C}_{123} = \mathbf{A}_{12} \times \mathbf{B}_1$}\\[0.5ex]
			& \adj{$C_{123,M+0} = A_{12,M+0} \cdot B_{1,M+0}$}\\ [0.5ex]
			& \adj{$C_{123,M+1} = A_{12,M+0} \cdot B_{1,M+1} + A_{12,M+1} \cdot B_{1,M+0}$}\\ [0.5ex]
			& \adj{$C_{123,M+2} = A_{12,M+1} \cdot B_{1,M+1} + A_{12,M+2} \cdot B_{1,M+0}$}\\ [0.5ex]
			& \adj{$C_{123,M+3} = A_{12,M+2} \cdot B_{1,M+1}$} \\ [0.5ex]
			\hline 
			\multirow{5}{*}[-1mm]{
				\begin{minipage}{0.3\linewidth}
					\centering{Реакция расщепления}
					\includegraphics[scale=0.85]{EMU_reaction_2.png}
				\end{minipage}
			} 
			& \adj{$\mathbf{C}_{123} = \mathbf{A}_{123}$}\\[.5ex]
			& \adj{$C_{123,M+0} = A_{123,M+0}$}\\ [.5ex]
			& \adj{$C_{123,M+1} = A_{123,M+1}$}\\ [.5ex]
			& \adj{$C_{123,M+2} = A_{123,M+2}$} \\ [.5ex]
			& \adj{$C_{123,M+3} = A_{123,M+3}$} \\ [.5ex]
			\hline 
			\multirow{5}{*}[-1mm]{
				\begin{minipage}{0.3\linewidth}
					\centering{Унимолекулярная реакция}
					\includegraphics[scale=0.85]{EMU_reaction_3.png}
				\end{minipage}
			} 
			& \adj{$\mathbf{C}_{123} = \mathbf{A}_{123}$}\\[.5ex]
			& \adj{$C_{123,M+0} = A_{123,M+0}$}\\ [.5ex]
			& \adj{$C_{123,M+1} = A_{123,M+1}$}\\ [.5ex]
			& \adj{$C_{123,M+2} = A_{123,M+2}$} \\ [.5ex]
			& \adj{$C_{123,M+3} = A_{123,M+3}$} \\ [.5ex]
			\hline 
		\end{tabular}
		\caption{EMU-реакции}
		\label{EMU_reactions}
	\end{center}
\end{table} % ---------------------- Можно что-то вписать

\begin{figure}[h!]
	\centering
	\begin{minipage}[l]{.5\textwidth}
		\centering
		\includegraphics[scale=0.11]{full_emu_map.png}
		\caption{Метаболическая сеть}
		\label{emu_example}
	\end{minipage}%
	\begin{minipage}[r]{.5\textwidth}
		\centering
		\small
		\begin{tabular}{c c c}
			\hline
			№ & Реакция & Переходы трейсера\\
			\hline
			1 & $A \to B$ & abc $\leftrightarrow$ abc\\
			2 и 3 & B $\leftrightarrow$ D & abc $\leftrightarrow$ abc\\
			4 & B $\to$ C + E & abc $\to$bc + a\\
			5 & B+C $\to$ D+E+E & abc+de $\to$ bcd+a+e\\
			6 & D $\to$ F & abc $\to$ abc\\
			\hline
		\end{tabular}
		\captionof{table}{Ее химические уравнения}
		\label{emu_example_table}
	\end{minipage}
\end{figure}


\clearpage
\begin{wraptable}[25]{l}{0.5\linewidth}
	\begin{tabular}{c c c}
		\hline
		№ & EMU-реакция & Размер\\
		\hline
		6 & $D_{123} \to F_{123}$ & $3 = 3$\\
		2 & $B_{123} \to D_{123}$ & $3 = 3$\\
		5 & $B_{23} + C_1 \to D_{123}$ & $2 + 1 = 3$\\
		1 & $A_{123} \to B_{123}$ & $3 = 3$\\
		3 & $D_{123} \to B_{123}$ & $3 = 3$\\
		1 & $A_{23} \to B_{23}$ & $2 = 2$\\
		3 & $D_{23} \to B_{23}$ & $2 = 2$\\
		2 & $B_{23} \to D_{23}$ & $2 = 2$\\
		5 & $B_3 + C_1 \to D_{23}$ & $1 + 1 = 2$\\
		4 & $B_2 \to C_1$ & $1 = 1$\\
		1 & $A_2 \to B_2$ & $1 = 1$\\
		3 & $D_2 \to B_2$ & $1 = 1$\\
		2 & $B_2 \to D_2$ & $1 = 1$\\
		5 & $B_3 \to D_2$ & $1 = 1$\\
		1 & $A_3 \to B_3$ & $1 = 1$\\
		3 & $D_3 \to B_3$ & $1 = 1$\\
		2 & $B_3 \to D_3$ & $1 = 1$\\
		5 & $C_1 \to D_3$ & $1 = 1$\\
	\end{tabular}
	\caption{Список реакций, для определения MID $F_{123}$}
	\label{all_emu_reactions}
\end{wraptable}


Например, рассмотрим метаболическую сеть с рис. \ref{emu_example} и таблицы \ref{emu_example_table}. Известна меченность входного субстрата $A$, то есть известны MID всех EMU $A$. Требуется найти $\mathbf{F}_{123}$. Оно формируется в EMU-реакции $$D_{123} \to F_{123},$$ поэтому надо найти $\mathbf{D}_{123}$. Оно задается двумя EMU-реакциями: $$B_{123} \leftrightarrow D_{123},$$ $$B_{23} + C_1 \to D_{123}.$$ Значит еще надо определить $\mathbf{B}_{123}$, $\mathbf{B}_{23}$ и $\mathbf{C}_1$. Проведя поиск в глубину, найдем список EMU, MID которых надо узнать и заодно составим список EMU-реакций. Реакции нашего примера выписаны в таблице \ref{all_emu_reactions}.

Для всех EMU-реакций одного размера построим EMU-граф. Это ориентированный граф, вершины которого --- субстраты и продукты EMU-реакций, причем субстратам реакций конденсации сопоставим свертки, согласно таблице \ref{EMU_reactions}. Например, $B_{23} + C_1 = B_{23} \times C_1$. Обратим внимание, что вершины, не имеющие входящих ребер, либо являются входными EMU, чьи MID известны, либо являются сверткой EMU меньшего размера, это следует из предположения (2П). EMU-графы нашего примера на рис. \ref{emu_graph}.

\begin{figure}[b]
	\begin{subfigure}{.3\linewidth}
		\includegraphics[width=\linewidth]{EMU_graph_1.png}
		\caption{размера 1}
		\label {emu_graph_1}
	\end{subfigure}
	\begin{subfigure}{.3\linewidth}
		\includegraphics[width=\linewidth]{EMU_graph_2.png}
		\caption{размера 2}
		\label {emu_graph_2}
	\end{subfigure}
	\begin{subfigure}{.3\linewidth}
		\includegraphics[width=1.2\linewidth]{EMU_graph_3.png}
		\caption{размера 3}
		\label {emu_graph_3}
	\end{subfigure}
	\caption{EMU-графы}
	\label{emu_graph}
\end{figure}

\clearpage

\subsection{Каскад уравнений}
Для каждого EMU-графа составим СЛАУ:
$$\mathbf{A}(\mathbf{v}) \mathbf{X} = \mathbf{B}(\mathbf{v}) \mathbf{Y}.$$
Строки $\mathbf{X}$ --- это неизвестные MID графа. Матрица $\mathbf{Y}$, аналогично, содержит известные MID, так что $y_{ij}$ равняется массовой доле молекул $i$-го EMU с известным MID с $j - 1$ атомами трейсера.

\noindent $\mathbf{A}(\mathbf{v})$ --- матрица потоков такая, что 
$a_{ij} = 
\begin{cases} 
	\text{$-\sum$потоков входящих в $X_i$, $i=j$}\\
	\text{поток из $X_j$ в $X_i$, $i\neq{}j$}
	\end{cases}
	$
 $\mathbf{B}(\mathbf{v})$ составляется аналогично $\mathbf{A}(\mathbf{v})$ для известных MID $\mathbf{Y}$. Доказано, что матрица $\mathbf{A}(\mathbf{v})$ всегда обратима\cite{anderson_1983}.
Найдя $\mathbf{X} = \mathbf{A}^{-1}(\mathbf{v})\mathbf{B}(\mathbf{v})\mathbf{Y}$, мы найдем MID всех EMU графа. Часть из них используется для решения СЛАУ следующего уровня.

Таким образом, получим каскад СЛАУ:
$$\mathbf{A}_1(\mathbf{v})\mathbf{X}_1 = \mathbf{B}_1(\mathbf{v})\mathbf{Y}_1(\mathbf{x}_{in}),$$
$$\mathbf{A}_2(\mathbf{v})\mathbf{X}_2 = \mathbf{B}_2(\mathbf{v})\mathbf{Y}_2(\mathbf{x}_{in}, \mathbf{X}_1),$$
$$\dots$$
$$\mathbf{A}_n(\mathbf{v})\mathbf{X}_n = \mathbf{B}_n(\mathbf{v})\mathbf{Y}_n(\mathbf{x}_{in}, \mathbf{X}_1, \ldots, \mathbf{X}_{n - 1}).$$
Решив его, найдем искомые MID. В нашем примере уравнения выглядят так:

$$\begin{bmatrix}
-v_4 & v_4 & 0 & 0 & 0\\
0 & -v_1-v_3 & v_3 & 0 & 0\\
0 & v_2 & -v_2-v_5 & v_5 & 0\\
0 & 0 & 0 & -v_1-v_3 & v_3 \\
v_5 & 0 & 0 & v_2 & -v_2-v_5\\
\end{bmatrix}
\begin{bmatrix}
	\mathbf{C}_1\\
	\mathbf{B}_2\\
	\mathbf{D}_2\\
	\mathbf{B}_3\\
	\mathbf{D}_3\\
\end{bmatrix}
=
\begin{bmatrix}
	0 & 0\\
	-v_1 & 0\\
	0 & 0\\
	0 & -v_1\\
	0 & 0\\
\end{bmatrix}
\begin{bmatrix}
	\mathbf{A}_2\\
	\mathbf{A}_3\\
\end{bmatrix}$$

$$\begin{bmatrix}
-v_5-v_2 & v_2\\
v_3 & -v_1-v_3\\
\end{bmatrix}
\begin{bmatrix}
\mathbf{D}_{23}\\
\mathbf{B}_{23}
\end{bmatrix}
=
\begin{bmatrix}
-v_5 & 0\\
0 & -v_1\\
\end{bmatrix}
\begin{bmatrix}
\mathbf{B}_3 \times \mathbf{C}_1\\
\mathbf{A}_{23}
\end{bmatrix}$$

$$\begin{bmatrix}
-v_6 & v_6 & 0\\
0 & -v_5-v_2 & v_2\\
0 & v_3 & -v_1-v_3\\
\end{bmatrix}
\begin{bmatrix}
\mathbf{F}_{123}\\
\mathbf{D}_{123}\\
\mathbf{B}_{123}\\
\end{bmatrix}
=
\begin{bmatrix}
0 & 0\\
-v_5 & 0\\
0 & -v_1\\
\end{bmatrix}
\begin{bmatrix}
\mathbf{B}_{23} \times \mathbf{C}_1\\
\mathbf{A}_{123}\\
\end{bmatrix}
$$
Еще раз обратим внимание, что в момент решения каждой СЛАУ, в правых частях записаны только известные MID. Решив весь каскад, найдем выходной MID $\mathbf{F}_{123}$.
\clearpage
\section{Статистический анализ}
\subsection{Статистическая значимость}
Один из способов исследования статистической значимости решения задачи регрессии основан на применении $\chi^2$-статистики\cite{shupltesov_review_2}. Будем считать, что каждый член суммы формулы регрессии (1.1) является случайной величиной $\sim \mathcal{N}(0, 1)$. Гипотеза $H_0$ заключается в том, что сумма квадратов разностей $\xi_{SSR}$ (1.1), являясь суммой случайных величин, удовлетворяет распределению $\chi^2$. Число степеней свободы этого распределения равно числу независимых измерений $W$ минус число оцениваемых параметров (то есть число свободных потоков) $p$\cite{shupltesov_review_2}. $H_1$ --- значит, что $\xi_{SSR}$ имеет другое распределение. Таким образом, критерий значимости:
$$
\sigma(\xi_{SSR}) = \begin{cases}
	H_0,&\text{если $\chi^2_{\alpha / 2}(W - p) \le \xi_{SSR} \le \chi^2_{1 - \alpha}(W - p)$}\\
	H_0,&\text{если $\xi_{SSR} \leq \chi^2_{\alpha / 2}(W - p)$, но возможно переобучение}\\
	H_1,&\text{если $\xi_{SSR} \geq \chi^2_{1 - \alpha}(W - p)$}\\
\end{cases}$$
\subsection{Доверительные интервалы}
Задачу нахождения доверительных интервалов можно решать разными способами. Один из них основан на подходе Монте-Карло. Для нахождения доверительных интервалов в исходные данные искусственно вносят ошибки, имеющие нормальное распределение, и решают задачу регрессии для новых ошибочных данных. После получения облака решений, в \cite{OpenFlux2} рекомендуется использовать метод отбрасывания максимальных и минимальных оценок. Это значит, что для 95\%-го доверительного интервала отбрасываются 2.5\% самых меньших и 2.5\% самых больших оценок.

Используя разные техники построение доверительных интервалов, можно получить разные оценки. Это продемонстрировано в работе \cite{bayesian}, авторы которой предлагают подход, основанный на байесианской статистике, с использованием Монте-Карло Марковских цепей.

Вопросы статистического анализа также поднимались в следующих статьях: \cite{Wiechert_1999_3, Wiechert_1999_4, ci_antoniewicz, bayesian, bayesian_2, bayesian_3}

\clearpage
\section{Дополнительные соображения}
Формат этой работы не позволяет описать все технические особенности метода. Здесь собраны некоторые вопросы, которые надо решить для написания собственной программы, но которые опущены ради лаконичности.
\begin{itemize}
	\item До масс-спектрометрии для MFA использовался ядерно-магнитный резонанс(ЯМР). Как составить EMU-модель для ЯМР-данных?\cite{EMU_2007}
	\item Какой метод оптимизации использовать?\cite{adjoint_approach, protocol, optimization_in_mfa} \cite[препринт]{2019_gradient}
	\item Градиентные методы оптимизации требуют производную целевой функции (1.1). Как ее составить и, в частности, как найти аналитическую производную EMU-модели? \cite{EMU_2007, protocol}
	\item Матрицы каскада, как и EMU-графы получаются разреженными. Как используя структуру графа, построить графовые декомпозиции для оптимизации вычислений? \cite{topology, emu_topology}
	\item Тяжелые изотопы встречаются в клетке до \ce{{}^13C}-эксперимента. Как это учесть?\cite{protocol}
	\item Как выбрать входной субстрат, чтобы увеличить точность вычисления потоков, снизив стоимость расходных материалов? \cite{planning_optimal, planning_optimal_2, planning_optimal_3, planning_optimal_4} 
	\item MID каких метаболитов замерять в эксперименте, чтобы увеличить точность вычисления потоков? \cite{optimal_measurements}
\end{itemize}

\chapter[Постановка задачи]{\thechapter{}. Постановка задачи}
\begin{itemize}
	\item Написать эффективную программу для \ce{^{13}C}-MFA расчета \\на языке~\CC.
	\item Провести тестирование, сравнить скорость работы\\с существующими аналогами.
\end{itemize}

\chapter[Основная часть]{\thechapter{}. Основная часть}
\section{Программа Khnum}
В результате была написана программа Khnum. Это эффективная программа для проведения \ce{^{13}C}-MFA расчетов. Она написана на современном \CC{} и имеет открытый код. В ней используются открытые библиотеки:
\begin{itemize}
	\item Eigen --- Библиотека линейной алгебры.
	\item Alglib --- Многофункциональная библиотека. Используются алгоритм Левенберга-Марквардта для решения задачи оптимизации и алгоритм иерархической кластеризации.
	\item Catch2 --- Библиотека для тестирования.
	\item glpk --- GNU Linear Programming Kit. Используется для решение задачи линейного программирования.
\end{itemize}
Исходный код доступен по ссылке: \texttt{https://github.com/SteshinSS/khnum}

\section{Тестирование}
Чтобы проверить правильность, Khnum была запущена на нескольких метаболических моделях. Результат вычислений совпал с результатами FluxPyt и OpenFLUX.

Чтобы проверить производительность, была взята метаболическая модель из 169 реакций. Для нее было запущено 30 итераций решения задачи регрессии на системе Ubuntu 19.10, Intel Core i9-9880H, 8 ядер, 512 KiB кеш L1, 2 MiB L2, 16 MiB L3, расширениями AVX2, со включенным Hyper-Threading. Пока было замерено только время работы OpenFLUX: 35 минут ровно. Khnum в однопоточном режиме справился за 23 секунды, и за 4 секунды при распараллеливании на все ядра.

\clearpage
\section{Архитектура программы}

На рис. \ref{architecture} приведена схема работы программы. Кроме этого потока данных, есть еще вспомогательные модули. Например, обертка над библиотекой glpk, чтобы избежать утечек памяти. Для отладки были написаны специальные функции и скрипты. Например, скрипт на Python строит изображение EMU-графов с помощью библиотеки graphviz.

\begin{figure}
	\includegraphics[width=0.9\textwidth]{block_scheme.png}
	\caption{Архитектура Khnum}
	\label{architecture}
\end{figure}
\clearpage

\section{М-матрицы}
При MFA-расчетах, большую часть процессорного времени занимает решение СЛАУ. Мы покажем, что матрицы $\mathbf{A}$ каскада СЛАУ, взятые со знаком минус, являются М-матрицами, из-за чего сможем применить специальные численные методы. Для этого рассмотрим известные результаты теории неотрицательных матриц.

Квадратная матрица $\mathbf{A} \in \mathbb{R}^{n \times n}$ называется \emph{М-матрицей}(Ostrowski, 1937)\cite{m_matrix_orig}, если:
\begin{enumerate}
	\item Ее диагональные элементы больше или равны нулю $a_{ii} \ge 0$, $i = j$
	\item Ее внедиагональные элементы меньше или равны нулю $a_{ij} \le 0$, $i \neq j$
	\item Матрицу $\mathbf{A}$ можно представить в виде: $\mathbf{A} = s\mathbf{I} - \mathbf{B}$, где $s > 0$, $\mathbf{B} \ge 0$, $s > \rho(\mathbf{B})$, где $\rho(\mathbf{B})$ --- спектральный радиус $\mathbf{B}$
\end{enumerate}
Эти матрицы активно изучаются с 80х годов, потому что возникают при дискретизации дифференциальных уравнений в частных производных и в экономике. В частности, М-матрицы появляются при использовании метода конечных разностей в гидродинамике\cite{m_matrix_application_1, m_matrix_application_2,m_matrix_application_3,m_matrix_application_4}.

\newtheorem{theorem}{Теорема}
\begin{theorem}[Критерий М-матрицы (Fiedler, Ptak, 1962)\cite{m_matrix_def}]
	\label{m_matrix_criterion}
	Квадратная матрица $\mathbf{A}$ является М-матрицей тогда и только тогда, когда она невырожденная и все вещественные собственные значения ее главных миноров больше или равны нулю. 	
\end{theorem}

Для оценки собственных значений нам понадобится:
\begin{theorem}[Теорема кругов Гершгорина (Гершгорин, 1931)\cite{circle_theorem}]
	\label{circle_theorem}
	Пусть $\mathbf{A} \in \mathbb{C}^{n \times n}$ --- комплексная матрица. Пусть $R_i = \sum_{i \neq j} |a_{ij}|$ --- сумма модулей внедиагональных элементов $i$ строки. Кругом Гершгорина назовем замкнутый круг $D(a_{ii}, R_i)$ с центром в $a_{ii}$ и радиусом $R_i$. Тогда каждое собственное значение матрицы $\mathbf{A}$ лежит хотя бы в одном круге Гершгорина. 
\end{theorem}

Покажем, что если взять матрицу коэффициентов $\mathbf{A}(\mathbf{v})$ со знаком минус, всегда получим М-матрицу. Для удобства обозначим: $\hat{\mathbf{A}} = -\mathbf{A}$. Структура получившейся матрицы:

$X$ --- матрица искомых EMU.

$a_{ij} = 
\begin{cases} 
\text{$\sum$потоков входящих в $X_i$, $i=j$}\\
\text{$-$ поток из $X_j$ в $X_i$, $i\neq{}j$}
\end{cases}
$
\clearpage


\begin{theorem}
	$\hat{\mathbf{A}}$ является М-матрицей.
\end{theorem}

\begin{proof}
	Докажем диагональное доминирование главных миноров. Для этого рассмотрим произвольную строку $i$ и соответствующий диагональный элемент $a_{ii} \in \hat{\mathbf{A}}$. Он равен сумме всех входящих потоков в $i$ EMU. Во внедиагональных элементах записаны входные потоки только из неизвестных EMU в $i$ EMU со знаком минус. Это значит, что $$a_{ii} \geq \sum_{i \neq j} |a_{ij}| = R_i.$$Очевидно любой главный минор такой матрицы $\hat{\mathbf{A}}$ тоже имеет диагональное доминирование. 
	
	По теореме кругов Гершгорина(Теорема \ref{circle_theorem}), каждое собственное значение лежит хотя бы в одном круге $D(a_{ii}, R_i)$. Так как $a_{ii} \geq R_i \geq 0$, собственные значения нестрого лежат в правой полуплоскости.
	
	Так как исходная матрица $\mathbf{A}$ обратима, то обратима и $\hat{\mathbf{A}}$.
	
	Применим критерий М-матрицы(Теорема \ref{m_matrix_criterion}). По нему $\hat{\mathbf{A}}$ является М-матрицей.	
\end{proof}

Это значит, для решения системы СЛАУ с помощью итеративных методов, мы можем применить специальный предобуславливатель --- ILU-разложение. 

\clearpage


\subsection{ILU-разложение}
Один из базовых методов решения систем линейных уравнений --- LU-разложение. Результат применения LU-разложения --- две треугольные матрицы, зная которые, легко решить исходную систему. Проблема в том, что этот метод неоптимален, если матрица коэффициентов разреженная. В этом случае, разложение создаст две матрицы, которые будут намного плотней исходной матрицы. Возможное решение --- рассмотреть приблизительное разложение, которое похоже на LU, но сохраняет разреженную структуру. Одно из таких разложений --- ILU-разложение.

В 1977 году J.Meijerink и H. Vorst, основываясь на идеях H. Stone\cite{proto_ilu}, предложили новое разложение М-матриц --- Incomplete LU-разложение\cite{ilu}. Опишем его.

Пусть $\mathbf{A} \in \mathbb{R}^{n \times n}$ --- разреженная матрица. Определим для нее \emph{разреженную структуру} $S = \{(i, j) | a_{ij} \neq 0\} \cup \{(i,i)\}$ состоящую из всех координат ненулевых элементов и всех диагональных координат. Назовем \emph{ILU-разложением} разложение вида $\mathbf{A} = \mathbf{L}\mathbf{U} - \mathbf{R}$, где
\begin{itemize}
	\item $\mathbf{L} \in \mathbb{R}^{n \times n}$ --- нижнетреугольная матрица
	\item $\mathbf{U} \in \mathbb{R}^{n \times n}$ --- верхнетреугольная матрица
	\item $\mathbf{L}, \mathbf{U}$ равны нулю вне разреженной структуры: $\mathbf{L}_{ij} = \mathbf{U}_{ij} = 0 \forall (i, j) \notin S$
	\item $\mathbf{R} \in \mathbb{R}^{n \times n}$ равна нулю в разреженной структуре: $\mathbf{R}_{ij} = 0 \forall (i, j) \in S$
\end{itemize}

Авторы доказали пару полезных теорем:
\begin{theorem}[Существование]
	Для любой М-матрицы существует ILU-разложение.
\end{theorem}
\begin{theorem}[Устойчивость]
	Пусть 
	
	$\mathbf{A}$ --- М-матрица. 
	
	Ее LU-разложение: $\mathbf{A} = \hat{\mathbf{L}}\hat{\mathbf{U}}$ 
	
	Ее ILU-разложение: $\mathbf{A} = \mathbf{LU} - \mathbf{R}$
	
	Тогда: $|\mathbf{L}_{ij}| \leq |\hat{\mathbf{L}}_{ij}| \forall i,j$
\end{theorem}

Учитывая, что $\mathbf{A} \approx \mathbf{LU}$, такое разложение удобно применять в качестве предобуславливателя к итеративному методу решения СЛАУ.

\clearpage
\subsection{Замеры}
Возьмем матрицу $\mathbf{A}$ размером 253х253 из настоящей метаболической модели и сравним численные методы. 
\begin{itemize}
	\item BiCGSTAB + ILU --- Стабилизированный метод бисопряженных\\градиентов\cite{BiCGSTAB} с использованием ILU-разложения в качестве предобуславливателя
	\item BiCGSTAB + Diag --- Стабилизированный метод бисопряженных градиентов с использованием диагонали матрицы $\mathbf{A}$ в качестве предобуславливателя
	\item DenseLU --- Стандартный метод решения СЛАУ с использованием LU-разложения с перестановками строк (Partial Pivoting)
	\item SuperLU --- Специальный метод с использованием LU-разложения, оптимизированного для разреженных матриц\cite{SuperLU} с применением эвристического предобуславливателя COLAMD (Column Approximate Minimum Degree)\cite{COLAMD}
\end{itemize}
Воспользуемся реализациями библиотеки Eigen и сравним время работы методов. Скопилируем код с помощью gcc с опциями \texttt{-O2 -march=native} и включим флаг \texttt{EIGEN\_NO\_DEBUG}, чтобы сгенерировать оптимизированный код. Замеры проведем на системе Ubuntu 19.10, Intel Core i9-9880H, 8 ядер, 512 KiB кеш L1, 2 MiB L2, 16 MiB L3, расширениями AVX2, со включенным Hyper-Threading. Для этого 7 раз замерим время, отбросим самый долгий и самый короткий замеры и из оставшихся найдем среднее. Результаты представлены в таблицу \ref{methods_benchmark}.

\begin{table}[b]
	\centering
	\caption{Сравнение методов. Время в микросекундах\label{methods_benchmark}}
	\begin{tabular}{c|c|c|c}
		\hline
		BiCGSTAB + ILU & BiCGSTAB + Diag & DenseLU & SparseLU\\
		\hline
		125 & 986 & 645 & 174\\
	\end{tabular}
\end{table}

Дальнейшие измерения на М-матрице размером 253х253 показали, что использование стабилизированного метода бисопряженных градиентов\\(BiCGSTAB) с ILU-предобуславливателем ускоряет решение системы на 30\% в одном потоке и на 55\% при одновременном решении в 16 потоках, по сравнению со стандартным методом SuperLU из библиотеки Eigen. Интересно, что выигрыш больше, когда нагружены все ядра. Это можно объяснить тем, что итеративный метод использует меньше памяти, из-за чего количество обращений в кеш третьего уровня уменьшается в $1.3$ раза, а количество кеш-промахов уменьшается вдвое. 

\chapter[Полученные результаты]{\thechapter{}. Полученные результаты}
\begin{itemize}
	\item Написана эффективная открытая программа Khnum для проведения \ce{^{13}C}-MFA расчетов.
	\item Проведено сравнение с аналогами.
	\item Доказана принадлежность матрицы коэффициентов СЛАУ EMU модели к классу М-матриц. Это позволило использовать специальный предобуславливатель на основе ILU-разложения.
	\item Проведено сравнение нескольких численных методов для СЛАУ EMU модели. Показано, что численные методы с ILU-предобуславливателем работают быстрее всего.
\end{itemize}


\chapter[Заключение]{\thechapter{}. Заключение}
Высокопроизводительные вычисления --- это слаженная работа нескольких компонент. С точки зрения пользователя, от быстро сходящегося численного метода нет никакой пользы, если он плохо реализован. Если же код написан качественно, от него нет практической пользы, если он запущен на неподходящей архитектуре. Некоторые существующие статьи про математические методы анализа метаболических потоков заканчиваются программным прототипом\cite{adjoint_approach, bayesian_3, p13CMFA}. Чаще всего они написаны на Matlab или Python, которые являются интерпретируемыми языками. Это может исказить замеры производительности. Khnum --- первая программа на \CC{} с открытым кодом. Она разрабатывалась с упором на последующие изменения, поэтому состоит из многих независимых модулей. Исследователь может быстро изменить один из модулей на экспериментальный и проверить свои гипотезы. 

Кроме удобств для исследователя, программа уже полезна с точки зрения пользователя, потому что, возможно, является самой быстрой из существующих\footnote{На момент финальных правок, автор еще не получил самые популярные программы 13CFLUX2 и METRAN. Есть надежда, что Университет успеет заключить соглашение хотя бы к презентации диплома.}. Современные \ce{^{13}C}-MFA эксперименты проводят с большим количеством реакций и, изредка, с несколькими изотопами. В этих случаях, больше всего процессорного времени занимает решение СЛАУ. ILU-разложение отлично справляется с разреженными М-матрицами, которые возникают в EMU-модели, как доказано в этой работе.
 
\section{Дальнейшая работа}
Вычислительное ядро программы готово, но работа продолжается. Khnum и ILU-разложение выиграли ценный ресурс --- время процессора. Следующий шаг --- потратить этот ресурс на расчеты более сложной модели, моделирующей распространение нескольких изотопов одновременно. Это позволит проводить более дешевые, быстрые и точные эксперименты.


\begin{appendices}
	\chapter{Список программ для MFA-расчетов}
	\begin{itemize}
		\item \textbf{13CFLUX2} --- Самая популярная программа для \ce{^{13}C}-MFA. Написана на \CC{}, имеет закрытый исходный код и платна для коммерческого использования. Для исследовательских целей можно получить академическую лицензию по запросу\cite{13CFLUX2}, при этом все данные для расчетов надо заранее отправить авторам.
		
		\item \textbf{Metran} --- Написана автором EMU-модели. Закрытый код, бесплатная академическая лицензия по запросу. Написана на Matlab\cite{Metran}.
		
		\item \textbf{OpenFlux(2)} --- Пакет для Matlab\cite{OpenFlux, OpenFlux2}.
		
		\item \textbf{FluxPyt} --- Пакет для Python\cite{FluxPyt}.
		
		\item \textbf{mfapy} --- Пакет для Python.
		
		\item \textbf{Sysmetab} --- Автор предложил использовать метод оптимизации "Adjoint Approach"\cite{adjoint_approach} и написал программу в качестве демонстрации, с использованием Scilab.
		
		\item \textbf{baMFA} --- Пакет для Matlab с использованием Байесианской статистики\cite{bayesian_3}.
		
		\item \textbf{iso2flux} --- Пакет для Питона\cite{p13CMFA}.
		
		\item \textbf{Flux-P} --- Пакет для Matlab, для набора программ Bio-jETI\cite{Flux-P}.
		
		\item \textbf{WUFlux} --- Пакет для Matlab\cite{WUFlux}.
		
		\item \textbf{OpenMebius} --- Пакет для INST-\ce{^{13}C}-MFA расчетов. Написан на Matlab\cite{OpenMebius}.
		
		\item \textbf{influx\_s} --- Пакет для Python\cite{influxs}.
	\end{itemize}
	
\end{appendices}

\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{Список литературы}
\renewcommand{\bibname}{Список литературы}
\begin{thebibliography}{XXXX}
	\bibitem{Cancer_statistics}
	Всемирная Ассоциация Здравоохранения. Cancer [Электронный ресурс] URL: https://www.who.int/news-room/fact-sheets/detail/cancer (дата обращения: 12.03.2020)
	
	\bibitem{Warburg_effect}
	Warburg O., Wind F., Negelein E. The metabolism of tumors in the body // The Journal of general physiology.--- 1927. --- Т. 8. --- №. 6. --- С. 519.
	
	\bibitem{Diabetes_statistics}
	Zimmet P. et al. Diabetes mellitus statistics on prevalence and mortality: facts and fallacies Nature Reviews Endocrinology. --- 2016. --- Т. 12. --- №. 10. --- С. 616.
	
	\bibitem{Genentech_paper}
	Cohen S. N. et al. Construction of biologically functional bacterial plasmids in vitro // Proceedings of the National Academy of Sciences. --- 1973. --- Т. 70. --- №. 11. --- С. 3240--3244.
	
	\bibitem{Application_cancer_2009}
	Metallo C. M., Walther J. L., Stephanopoulos G. Evaluation of 13C isotopic tracers for metabolic flux analysis in mammalian cells // Journal of biotechnology. --- 2009. --- Т. 144. --- №. 3. --- С. 167--174.
	
	\bibitem{Application_cancer_2012}
	Walther J. L. et al. Optimization of 13C isotopic tracers for metabolic flux analysis in mammalian cells // Metabolic engineering. --- 2012. --- Т. 14. --- №. 2. --- С. 162--171.
	
	\bibitem{Application_cancer_2013}
	Hiller K., Metallo C. M. Profiling metabolic networks to study cancer metabolism // Current opinion in biotechnology. --- 2013. --- Т. 24. --- №. 1. --- С. 60--68.
	
	\bibitem{Application_cancer_2015}
	Boroughs L. K., DeBerardinis R. J. Metabolic pathways promoting cancer cell survival and growth // Nature cell biology. --- 2015. --- Т. 17. --- №. 4. --- С. 351--359.
	
	\bibitem{Application_cancer_2017}
	Dong W., Keibler M. A., Stephanopoulos G. Review of metabolic pathways activated in cancer cells as determined through isotopic labeling and network analysis // Metabolic engineering. --- 2017. --- Т. 43. --- С. 113--124.
	
	\bibitem{Application_cancer_2018}
	Antoniewicz M. R. A guide to 13 C metabolic flux analysis for the cancer biologist // Experimental \& molecular medicine. --- 2018. --- Т. 50. --- №. 4. --- С. 1--13.
	
	\bibitem{Application_cancer_2018_2}
	Badur M. G., Metallo C. M. Reverse engineering the cancer metabolic network using flux analysis to understand drivers of human disease // Metabolic engineering. --- 2018. --- Т. 45. --- С. 95--108.
	
	\bibitem{Application_engeneering_2009}
	Nakahigashi K. et al. Systematic phenome analysis of Escherichia coli multiple‐knockout mutants reveals hidden reactions in central carbon metabolism // Molecular systems biology. --- 2009. --- Т. 5. --- №. 1.
	
	\bibitem{Application_engeneering_2015}
	Crown S. B., Long C. P., Antoniewicz M. R. Integrated 13C-metabolic flux analysis of 14 parallel labeling experiments in Escherichia coli // Metabolic engineering. --- 2015. --- Т. 28. --- С. 151--158.
	
	\bibitem{Application_engeneering_2017}
	Long C. P. et al. Enzyme I facilitates reverse flux from pyruvate to phosphoenolpyruvate in Escherichia coli // Nature communications. --- 2017. --- Т. 8. --- №. 1. --- С. 1--8.
	
	\bibitem{Application_other_2011}
	Wahrheit J., Nicolae A., Heinzle E. Eukaryotic metabolism: measuring compartment fluxes // Biotechnology journal. --- 2011. --- Т. 6. --- №. 9. --- С. 1071--1085.
	
	\bibitem{Application_other_2013}
	Metallo C. M., Vander Heiden M. G. Understanding metabolic regulation and its influence on cell physiology // Molecular cell. --- 2013. --- Т. 49. --- №. 3. --- С. 388--398.
	
	\bibitem{Application_other_2014}
	Dieuaide-Noubhani M., Alonso A. P. (ed.). Plant metabolic flux analysis: methods and protocols. --- Humana Press, 2014.
	
	\bibitem{nitrogen_mfa}
	Nilsson R., Jain M. Simultaneous tracing of carbon and nitrogen isotopes in human cells // Molecular BioSystems. --- 2016. --- Т. 12. --- №. 6. --- С. 1929--1937.
	
	\bibitem{sulfur_mfa}
	Krömer J. O. et al. Accumulation of homolanthionine and activation of a novel pathway for isoleucine biosynthesis in Corynebacterium glutamicum McbR deletion strains // Journal of bacteriology. --- 2006. --- Т. 188. --- №. 2. --- С. 609--618.
	
	\bibitem{protocol}
	Systems Metabolic Engineering. Methods and Protocols. // Под ред. Alper, Hal S. --- 1 изд. Humana Press, 2013. --- 474 с.
	
	\bibitem{protocol_animal}
	(ed.). Metabolic flux analysis: methods and protocols. // Под ред. Krömer J. O., Nielsen L. K., Blank L. M. --- 1 изд. Humana Press, 2014. --- 329 с.
	
	\bibitem{protocol_plant}
	Plant metabolic flux analysis: methods and protocols. // Под ред. Dieuaide-Noubhani M., Alonso A.P. --- 1 изд. Humana Press, 2014. --- 366 с.
	
	\bibitem{first_MFA}
	Blumstein S. E., Isaacs E., Mertus J. The role of the gross spectral shape as a perceptual cue to place of articulation in initial stop consonants // The Journal of the Acoustical Society of America. --- 1982. --- Т. 72. --- №. 1. --- С. 43-50.
	
	\bibitem{Wiechert_1997_1}
	Wiechert W., de Graaf A. A. Bidirectional reaction steps in metabolic networks: I. Modeling and simulation of carbon isotope labeling experiments // Biotechnology and bioengineering. --- 1997. --- Т. 55. --- №. 1. --- С. 101--117.
	
	\bibitem{Wiechert_1997_2}
	Wiechert W. et al. Bidirectional reaction steps in metabolic networks: II. Flux estimation and statistical analysis // Biotechnology and bioengineering. --- 1997. --- Т. 55. --- №. 1. --- С. 118--135.
	
	\bibitem{Wiechert_1999_3}
	Wiechert W. et al. Bidirectional reaction steps in metabolic networks: III. Explicit solution and analysis of isotopomer labeling systems // Biotechnology and bioengineering. --- 1999. --- Т. 66. --- №. 2. --- С. 69--85.
	
	\bibitem{Wiechert_1999_4}
	Möllney M. et al. Bidirectional reaction steps in metabolic networks: IV. Optimal design of isotopomer labeling experiments // Biotechnology and bioengineering. --- 1999. --- Т. 66. --- №. 2. --- С. 86---103.
	
	\bibitem{13CFlux1}
	Wiechert W. et al. A universal framework for 13C metabolic flux analysis // Metabolic engineering. --- 2001. --- Т. 3. --- №. 3. --- С. 265-283.
	
	\bibitem{Direct_MFA}
	Rantanen A. et al. Algorithms for 13C metabolic flux analysis. --- 2006.
	
	\bibitem{Markov_chain_MFA}
	Huo Y., Ji P. Continuous-Time Markov Chain-Based Flux Analysis in Metabolism // Journal of Computational Biology. --- 2014. --- Т. 21. --- №. 9. --- С. 691-698.
	
	\bibitem{Fluxomer_MFA}
	Srour O., Young J. D., Eldar Y. C. Fluxomers: a new approach for 13 C metabolic flux analysis // BMC systems biology. --- 2011. --- Т. 5. --- №. 1. --- С. 129.
		
	\bibitem{13CFLUX2}
	Weitzel M. et al. 13CFLUX2—high-performance software suite for 13C-metabolic flux analysis // Bioinformatics. --- 2013. --- Т. 29. --- №. 1. --- С. 143--145.
	
	\bibitem{Metran}
	Yoo H. et al. Quantifying reductive carboxylation flux of glutamine to lipid in a brown adipocyte cell line // Journal of Biological Chemistry. --- 2008 --- Т. 283. --- №. 30. --- С. 20621-20627.
	
	\bibitem{OpenFlux}
	Quek L. E. et al. OpenFLUX: efficient modelling software for 13 C-based metabolic flux analysis // Microbial cell factories. --- 2009. --- Т. 8. --- №. 1. --- С. 25.
	
	\bibitem{OpenFlux2}
	Shupletsov M. S. et al. OpenFLUX2: 13 C-MFA modeling software package adjusted for the comprehensive analysis of single and parallel labeling experiments // Microbial cell factories. --- 2014. --- Т. 13. --- №. 1. --- С. 152.
	
	\bibitem{FluxPyt}
	Desai T. S., Srivastava S. FluxPyt: a Python-based free and open-source software for 13C-metabolic flux analyses // PeerJ. --- 2018. --- Т. 6. --- С. e4716.
	
	\bibitem{NMFA}
	Wiechert W., Nöh K. Isotopically non-stationary metabolic flux analysis: complex yet highly informative // Current opinion in biotechnology. --- 2013. --- Т. 24. --- №. 6. --- С. 979--986.
	
	\bibitem{DMFA}
	Leighty R. W., Antoniewicz M. R. Dynamic metabolic flux analysis (DMFA): a framework for determining fluxes at metabolic non-steady state // Metabolic engineering. --- 2011. --- Т. 13. --- №. 6. --- С. 745--755.

	\bibitem{EMU_2007}
	Antoniewicz M. R., Kelleher J. K., Stephanopoulos G. Elementary metabolite units (EMU): a novel framework for modeling isotopic distributions // Metabolic engineering. --- 2007 --- Т. 9. --- №. 1. --- С. 68--86.
	
	\bibitem{formalizm_2017}
	Borkum M. I. et al. Modeling framework for isotopic labeling of heteronuclear moieties // Journal of cheminformatics. --- 2017. --- Т. 9. --- №. 1. --- С. 1--11.

	
	\bibitem{anderson_1983}
	Anderson M. J., Fambrough D. M. Aggregates of acetylcholine receptors are associated with plaques of a basal lamina heparan sulfate proteoglycan on the surface of skeletal muscle fibers // The Journal of cell biology. --- 1983. --- Т. 97. --- №. 5. --- С. 1396-1411.
	
	\bibitem{shupltesov_review_2}
	Шуплецов М. С., Голубева Л. И., Машко С. В. Анализ метаболических потоков с использованием 13 С-изотопов (13 C-MFA). II. Математические основы метода // Биотехнология --- 2016. --- Т. 32. --- №. 6. --- С. 9-34.
	
	
	\bibitem{bayesian}
	Theorell A. et al. To be certain about the uncertainty: Bayesian statistics for 13C metabolic flux analysis // Biotechnology and bioengineering. --- 2017. --- Т. 114. --- №. 11. --- С. 2668-2684.
	
	\bibitem{ci_antoniewicz}
	Antoniewicz M. R., Kelleher J. K., Stephanopoulos G. Determination of confidence intervals of metabolic fluxes estimated from stable isotope measurements // Metabolic engineering. --- 2006. --- Т. 8. --- №. 4. --- С. 324-337.
	
	\bibitem{bayesian_2}
	Theorell A., Nöh K. Model Uncertainty Analysis for Metabolic Network Inference: A Case Study in Bayesian Model Averaging // IFAC-PapersOnLine. --- 2018. --- Т. 51. --- №. 19. --- С. 124-125.
	
	\bibitem{bayesian_3}
	Heinonen M. et al. Bayesian metabolic flux analysis reveals intracellular flux couplings // Bioinformatics. --- 2019. --- Т. 35. --- №. 14. --- С. i548-i557.
	
	\bibitem{2019_gradient}
	Mottelet S. Fast computation of gradient and sentitivity in 13C metabolic flux analysis instationary experiments using the adjoint method // arXiv preprint arXiv:1206.5072. --- 2012.
	
	\bibitem{adjoint_approach}
	Mottelet S., Gaullier G., Sadaka G. Metabolic flux analysis in isotope labeling experiments using the adjoint approach // IEEE/ACM transactions on computational biology and bioinformatics. --- 2016. --- Т. 14. --- №. 2. --- С. 491-497.
	
	\bibitem{optimization_in_mfa}
	Maranas C. D., Zomorrodi A. R. Optimization methods in metabolic networks. --- John Wiley \& Sons, 2016.
	
	\bibitem{topology}
	Weitzel M., Wiechert W., Nöh K. The topology of metabolic isotope labeling networks // BMC bioinformatics. --- 2007. --- Т. 8. --- №. 1. --- С. 315.
	
	\bibitem{emu_topology}
	Young J. D. et al. An elementary metabolite unit (EMU) based method of isotopically nonstationary flux analysis // Biotechnology and bioengineering. --- 2008. --- Т. 99. --- №. 3. --- С. 686-699.
	
	\bibitem{planning_optimal}
	Rantanen A. et al. Planning optimal measurements of isotopomer distributions for estimation of metabolic fluxes // Bioinformatics. --- 2006. --- Т. 22. --- №. 10. --- С. 1198-1206.
	
	\bibitem{planning_optimal_2}
	Antoniewicz M. R. 13C metabolic flux analysis: optimal design of isotopic labeling experiments // Current opinion in biotechnology. --- 2013. --- Т. 24. --- №. 6. --- С. 1116-1121.
	
	\bibitem{planning_optimal_3}
	Crown S. B., Long C. P., Antoniewicz M. R. Optimal tracers for parallel labeling experiments and 13C metabolic flux analysis: a new precision and synergy scoring system //Metabolic engineering. --- 2016. --- Т. 38. --- С. 10-18.
	
	\bibitem{planning_optimal_4}
	Crown S. B., Long C. P., Antoniewicz M. R. Integrated 13C-metabolic flux analysis of 14 parallel labeling experiments in Escherichia coli //Metabolic engineering. --- 2015. --- Т. 28. --- С. 151-158.
	
	\bibitem{optimal_measurements}
	Chang Y. J., Suthers P. F., Maranas C. D. Identification of optimal measurement sets for complete flux elucidation in metabolic flux analysis experiments // Biotechnology and bioengineering. --- 2008. --- Т. 100. --- №. 6. --- С. 1039-1049.
	
	\bibitem{m_matrix_orig}
	Ostrowski A. Über die Determinanten mit überwiegender Hauptdiagonale // Commentarii Mathematici Helvetici. --- 1937. --- Т. 10. --- №. 1. --- С. 69-96.
	
	\bibitem{nonegative_matrirces_book}
	Berman A., Plemmons R. J. Nonnegative matrices in the mathematical sciences. --- Society for Industrial and Applied Mathematics, 1994.
	
	\bibitem{m_matrix_application_1}
	Edwards M. G. M-matrix flux splitting for general full tensor discretization operators on structured and unstructured grids // Journal of Computational Physics. --- 2000. --- Т. 160. --- №. 1. --- С. 1-28.
	
	\bibitem{m_matrix_application_2}
	Seibold B. M-Matrices in meshless finite difference methods. --- Shaker, 2006.
	
	\bibitem{m_matrix_application_3}
	Sapagovas M., Griškonienė V., Štikonienė O. Application of M-matrices theory to numerical investigation of a nonlinear elliptic equation with an integral condition //  Nonlinear Anal., Model. Control. --- 2017. --- Т. 22. --- №. 4. --- С. 489-504.
	
	\bibitem{m_matrix_application_4}
	Turek V. Improving Performance of Simplified Computational Fluid Dynamics Models via Symmetric Successive Overrelaxation // Energies. --- 2019. --- Т. 12. --- №. 12. --- С. 2438.
	
	\bibitem{m_matrix_def}
	Fiedler M., Ptak V. On matrices with non-positive off-diagonal elements and positive principal minors // Czechoslovak Mathematical Journal. --- 1962. --- Т. 12. --- №. 3. --- С. 382-400.
	
	\bibitem{circle_theorem}
	Gershgorin S. A. Uber die abgrenzung der eigenwerte einer matrix // Известия Российской академии наук. Серия математическая. --- 1931. --- №. 6. --- С. 749-754.
	
	\bibitem{ilu}
	Meijerink J. A., Van Der Vorst H. A. An iterative solution method for linear systems of which the coefficient matrix is a symmetric M-matrix // Mathematics of computation. --- 1977. --- Т. 31. --- №. 137. --- С. 148-162.
	
	\bibitem{proto_ilu}
	Stone H. L. Iterative solution of implicit approximations of multidimensional partial differential equations // SIAM Journal on Numerical Analysis. --- 1968. --- Т. 5. --- №. 3. --- С. 530-558.
	
	\bibitem{BiCGSTAB}
	Van der Vorst H. A. Bi-CGSTAB: A fast and smoothly converging variant of Bi-CG for the solution of nonsymmetric linear systems // SIAM Journal on scientific and Statistical Computing. --- 1992. --- Т. 13. --- №. 2. --- С. 631-644.
	
	\bibitem{SuperLU}
	Li X. S. An overview of SuperLU: Algorithms, implementation, and user interface // ACM Transactions on Mathematical Software (TOMS). --- 2005. --- Т. 31. --- №. 3. --- С. 302-325.
	
	\bibitem{COLAMD}
	Markowitz H. M. The elimination form of the inverse and its application to linear programming // Management Science. --- 1957. --- Т. 3. --- №. 3. --- С. 255-269.
	
	\bibitem{p13CMFA}
	Foguet C. et al. p13CMFA: Parsimonious 13C metabolic flux analysis // PLoS computational biology. --- 2019. --- Т. 15. --- №. 9. --- С. e1007310.
	
	\bibitem{Flux-P}
	Ebert B. E. et al. Flux-P: automating metabolic flux analysis // Metabolites. --- 2012. --- Т. 2. --- №. 4. --- С. 872-890.
	
	\bibitem{WUFlux}
	He L. et al. WUFlux: an open-source platform for 13 C metabolic flux analysis of bacterial metabolism // BMC bioinformatics. --- 2016. --- Т. 17. --- №. 1. --- С. 444.
	
	\bibitem{OpenMebius}
	Kajihata S. et al. OpenMebius: an open source software for isotopically nonstationary 13C-based metabolic flux analysis // BioMed research international. --- 2014. --- Т. 2014.
	
	\bibitem{influxs}
	Sokol S., Millard P., Portais J. C. Influx\_s: increasing numerical stability and precision for metabolic flux analysis in isotope labelling experiments // Bioinformatics. --- 2012. --- Т. 28. --- №. 5. --- С. 687-693.
	
\end{thebibliography}



\end{document}          
